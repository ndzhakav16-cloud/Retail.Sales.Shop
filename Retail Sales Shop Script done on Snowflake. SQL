
  
SELECT

  COUNT (DISTINCT 'transaction_id') AS Number_of_Sales,
  COUNT (DISTINCT 'Customer_Id') AS Number_of_Customers,
  SUM(TOTAL_AMOUNT)AS Revenue,
  SUM(QUANTITY)AS QUANTITY_SOLD,

  GENDER,
  PRODUCT_CATEGORY,
  

CASE

  WHEN AGE BETWEEN 18 AND 30 THEN'Youth'
  WHEN AGE BETWEEN 31 AND 45 THEN'Adult'
  WHEN AGE BETWEEN 45 AND 55 THEN'Senior'
  ELSE 'Elder'
END AS Age_Buckets,

 

CASE
  WHEN TOTAL_AMOUNT BETWEEN 25 AND 50 THEN'LOW SPENDER'
  WHEN TOTAL_AMOUNT BETWEEN 51 AND 70 THEN'MEDIUM SPENDER'
  WHEN TOTAL_AMOUNT BETWEEN 71 AND 100 THEN'HIGH SPENDER'
  WHEN TOTAL_AMOUNT BETWEEN 101 AND 150 THEN 'BIG SPENDR'
  ELSE 'BIGER SPENDER'
END AS AMOUNT_BUCKETS, 
 

   TO_DATE(Date)AS Purchased_date,
   DAYNAME(TO_DATE(DATE))AS DAY_NAME,
   MONTHNAME(TO_DATE(DATE))AS MONTH_NAME,
   DAYOFMONTH(TO_DATE(DATE))AS DAY_OF_MONTH,
   TO_CHAR(DATE,'YYYY') AS YEAR5,

 
  

  
FROM
  "RETAILS"."SALES"."SHOPS"
GROUP BY ALL;
 
