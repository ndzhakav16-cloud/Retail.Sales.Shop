SELECT*
FROM
  "RETAILS"."SALES"."SHOPS";


SELECT

  COUNT (DISTINCT 'transaction_id') AS      Number_of_Sales,
  COUNT (DISTINCT 'Customer_Id') AS Number_of_Unique_Customers,
  SUM(IFNULL (TOTAL_AMOUNT,0))AS Tota_Revenue,
  SUM(QUANTITY)AS QUANTITY_SOLD,
  

CASE

  WHEN AGE BETWEEN 0 AND 15 THEN'Kids'
  WHEN AGE BETWEEN 16 AND 25 THEN'Youth'
  WHEN AGE BETWEEN 26 AND 35 THEN'Adult'
  ELSE 'Elder'
END AS Age_Group,


CASE
  WHEN TOTAL_AMOUNT <=100 THEN'Low Spend'
  WHEN TOTAL_AMOUNT >100 AND TOTAL_AMOUNT<=300 THEN'Medium Spend'
  ELSE 'High Spend'
END AS Spend_Group, 


   TO_DATE(Date)AS Purchased_date,
   MONTHNAME(TO_DATE(DATE))AS MONTH_NAME,
   DAYNAME(TO_DATE(DATE))AS DAY_NAME,
   DAYOFMONTH(TO_DATE(DATE))AS DAY_OF_MONTH,
   TO_CHAR(DATE,'YYYY') AS YEAR5,

 
  GENDER,
  PRODUCT_CATEGORY,
  DAY_OF_MONTH,
  DAY_NAME,
  MONTH_NAME,
FROM
  "RETAILS"."SALES"."SHOPS"
GROUP BY ALL;
